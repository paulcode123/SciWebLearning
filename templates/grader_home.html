{% extends "base.html" %}

{% block title %}AI Grade Scanner - SciWeb{% endblock %}

{% block content %}
<script>window.SCIWEB_SPLASH = true;</script>
<div class="page-header">
    <h1 class="page-title" style="margin-bottom: 14px;">
        <i class="fas fa-graduation-cap icon"></i>
        AI Grade Scanner
    </h1>
    <p class="page-subtitle" style="opacity:1; animation:none;">
        Upload handwritten work and get instant AI-powered grading and feedback
    </p>
</div>

<!-- Hero Section -->
<div class="card" style="margin-bottom: 24px; background: var(--gradient-primary); border:none; color:white; text-align:center; padding:40px 30px;">
    <div style="max-width:720px; margin:0 auto;">
        <i class="fas fa-robot" style="font-size:4rem; margin-bottom:16px; opacity:0.95;"></i>
        <h2 style="color:white; font-size:2rem; margin-bottom:12px;">Your Virtual Teacher</h2>
        <p style="color:rgba(255,255,255,0.95); font-size:1.1rem; margin-bottom:24px; line-height:1.6;">
            Upload photos of handwritten assignments, tests, or problem sets. Our AI analyzes your work,
            grades each problem, and provides detailed feedback just like a real teacher.
        </p>
        <a href="{{ url_for('grader_upload') }}" class="btn" style="background:white; color:var(--accent-1); font-size:1.1rem; padding:14px 28px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
            <i class="fas fa-upload icon"></i>
            Upload Assignment
        </a>
    </div>
</div>

<!-- Features Grid -->
<div class="grid grid-3" style="margin-bottom:32px;">
    <div class="card" style="text-align:center; background: linear-gradient(135deg, rgba(91,134,229,0.08), rgba(54,209,220,0.08));">
        <div style="width:60px; height:60px; margin:0 auto 16px; border-radius:50%; background:var(--gradient-accent); display:flex; align-items:center; justify-content:center; box-shadow: var(--shadow-2xl);">
            <i class="fas fa-camera" style="font-size:1.5rem; color:white;"></i>
        </div>
        <h3 style="color: var(--text-primary); margin-bottom:8px;">Snap & Upload</h3>
        <p style="color: var(--text-secondary); line-height:1.5;">
            Take a photo of handwritten work or upload scanned documents. Supports JPG, PNG, PDF, and HEIC.
        </p>
    </div>
    <div class="card" style="text-align:center; background: linear-gradient(135deg, rgba(118,75,162,0.08), rgba(240,147,251,0.08));">
        <div style="width:60px; height:60px; margin:0 auto 16px; border-radius:50%; background:var(--gradient-primary); display:flex; align-items:center; justify-content:center; box-shadow: var(--shadow-2xl);">
            <i class="fas fa-brain" style="font-size:1.5rem; color:white;"></i>
        </div>
        <h3 style="color: var(--text-primary); margin-bottom:8px;">AI Analysis</h3>
        <p style="color: var(--text-secondary); line-height:1.5;">
            Advanced AI reads handwriting, evaluates answers, and identifies mistakes with precision.
        </p>
    </div>
    <div class="card" style="text-align:center; background: linear-gradient(135deg, rgba(250,112,154,0.08), rgba(254,225,64,0.08));">
        <div style="width:60px; height:60px; margin:0 auto 16px; border-radius:50%; background:var(--gradient-warm); display:flex; align-items:center; justify-content:center; box-shadow: var(--shadow-2xl);">
            <i class="fas fa-comments" style="font-size:1.5rem; color:white;"></i>
        </div>
        <h3 style="color: var(--text-primary); margin-bottom:8px;">Detailed Feedback</h3>
        <p style="color: var(--text-secondary); line-height:1.5;">
            Get constructive comments on each problem with suggestions for improvement.
        </p>
    </div>
</div>

<!-- Recent Submissions -->
<div class="card" style="margin-bottom:24px;">
    <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:20px;">
        <h2 style="color: var(--text-primary); margin:0; display:flex; align-items:center;">
            <i class="fas fa-history icon" style="color:var(--accent-1);"></i>
            Recent Submissions
        </h2>
        <a href="{{ url_for('grader_upload') }}" class="btn" style="padding:10px 18px;">
            <i class="fas fa-plus icon"></i>
            New Submission
        </a>
    </div>

    {% if submissions %}
    <div class="grid grid-2">
        {% for submission in submissions %}
        <div class="card" style="background: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(245,247,250,0.8));">
            <div style="display:flex; gap:16px; align-items:start;">
                <div style="width:80px; height:80px; border-radius:12px; overflow:hidden; flex-shrink:0; background:#f0f0f0; display:flex; align-items:center; justify-content:center; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    {% if submission.image_filename %}
                    <img src="{{ url_for('static', filename='uploads/grader/' + submission.image_filename) }}"
                         alt="Submission"
                         style="width:100%; height:100%; object-fit:cover;">
                    {% else %}
                    <i class="fas fa-file-alt" style="font-size:2rem; color:#ccc;"></i>
                    {% endif %}
                </div>
                <div style="flex:1; min-width:0;">
                    <h4 style="color: var(--text-primary); margin-bottom:6px; font-size:1.1rem;">{{ submission.title }}</h4>
                    <div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px;">
                        {% if submission.subject %}
                        <span class="badge" style="background: var(--gradient-accent); color:white; border:none;">{{ submission.subject }}</span>
                        {% endif %}
                        {% if submission.status == 'graded' %}
                        <span class="badge" style="background: var(--gradient-success); color:white; border:none;">
                            <i class="fas fa-check icon"></i>{{ submission.overall_score|round }}%
                        </span>
                        {% elif submission.status == 'pending' %}
                        <span class="badge" style="background: var(--gradient-warm); color:white; border:none;">
                            <i class="fas fa-clock icon"></i>Pending
                        </span>
                        {% else %}
                        <span class="badge" style="background: linear-gradient(135deg, #ff6b6b, #ee5a6f); color:white; border:none;">
                            <i class="fas fa-exclamation-triangle icon"></i>Error
                        </span>
                        {% endif %}
                    </div>
                    <p style="color: var(--text-secondary); font-size:0.9rem; margin-bottom:12px;">
                        <i class="fas fa-calendar icon"></i>{{ submission.created_at.strftime('%b %d, %Y at %I:%M %p') }}
                    </p>
                    <a href="{{ url_for('grader_result', submission_id=submission.id) }}"
                       class="btn"
                       style="padding:8px 14px; font-size:0.95rem;">
                        <i class="fas fa-eye icon"></i>
                        View Results
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div style="text-align:center; padding:60px 20px; background: linear-gradient(135deg, rgba(102,126,234,0.05), rgba(240,147,251,0.05)); border-radius:16px;">
        <i class="fas fa-clipboard" style="font-size:3rem; color:var(--accent-1); opacity:0.3; margin-bottom:16px;"></i>
        <h3 style="color: var(--text-secondary); margin-bottom:8px;">No submissions yet</h3>
        <p style="color: var(--text-secondary); margin-bottom:20px;">Upload your first assignment to get started!</p>
        <a href="{{ url_for('grader_upload') }}" class="btn">
            <i class="fas fa-upload icon"></i>
            Upload Now
        </a>
    </div>
    {% endif %}
</div>

<!-- How It Works -->
<div class="card" style="background: linear-gradient(135deg, rgba(102,126,234,0.06), rgba(240,147,251,0.06));">
    <h2 style="color: var(--text-primary); margin-bottom:20px; text-align:center;">
        <i class="fas fa-lightbulb icon" style="color:var(--accent-2);"></i>
        How It Works
    </h2>
    <div class="grid grid-3">
        <div style="text-align:center; padding:20px;">
            <div style="width:50px; height:50px; margin:0 auto 12px; border-radius:50%; background:var(--gradient-primary); color:white; display:flex; align-items:center; justify-content:center; font-size:1.5rem; font-weight:700;">1</div>
            <h4 style="color: var(--text-primary); margin-bottom:8px;">Upload</h4>
            <p style="color: var(--text-secondary); font-size:0.95rem;">Take a photo or upload a scan of your handwritten work</p>
        </div>
        <div style="text-align:center; padding:20px;">
            <div style="width:50px; height:50px; margin:0 auto 12px; border-radius:50%; background:var(--gradient-accent); color:white; display:flex; align-items:center; justify-content:center; font-size:1.5rem; font-weight:700;">2</div>
            <h4 style="color: var(--text-primary); margin-bottom:8px;">AI Grading</h4>
            <p style="color: var(--text-secondary); font-size:0.95rem;">Our AI analyzes and grades each problem automatically</p>
        </div>
        <div style="text-align:center; padding:20px;">
            <div style="width:50px; height:50px; margin:0 auto 12px; border-radius:50%; background:var(--gradient-warm); color:white; display:flex; align-items:center; justify-content:center; font-size:1.5rem; font-weight:700;">3</div>
            <h4 style="color: var(--text-primary); margin-bottom:8px;">Get Feedback</h4>
            <p style="color: var(--text-secondary); font-size:0.95rem;">Review detailed feedback and learn from your mistakes</p>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animate submission cards
    const cards = document.querySelectorAll('.grid .card');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.animation = `fadeInUp 0.6s ease-out ${0.1 * index + 0.2}s both`;
    });
});
</script>
{% endblock %}
